{"version":3,"sources":["observable/rx.js"],"names":["$rx","addRx","node","opts","id","name","val","soul","data","op","log","args","observer","listener","eventListener","event","next","Error","create","chain"],"mappings":";;;;;QAMgBA,G,GAAAA,G;QA+BAC,K,GAAAA,K;;AArChB;;AAGA;;;;;;AAEA;AACO,SAASD,GAAT,CAAaE,IAAb,EAA8B;AAAA,MAAXC,IAAW,uEAAJ,EAAI;;AACnC,MAAIC,WAAJ;AAAA,MAAQC,aAAR;AACAH,OAAKI,GAAL,CAAS,gBAAQ;AACfF,SAAK,cAAIF,IAAJ,CAASK,IAAT,CAAcC,IAAd,CAAL;AACAH,WAAOF,KAAKE,IAAL,IAAaD,EAAb,IAAmB,SAA1B;AACD,GAHD;AAIA,MAAMK,KAAKN,KAAKM,EAAL,IAAW,IAAtB;AACA,MAAMC,MAAM,SAANA,GAAM,GAAmB;AAC7B,QAAIP,KAAKO,GAAT,EAAc;AAAA;;AAAA,wCADSC,IACT;AADSA,YACT;AAAA;;AACZ,2BAAQD,GAAR,kBAAY,KAAZ,EAAmBL,IAAnB,SAA4BM,IAA5B;AACD;AACF,GAJD;;AAMA;;AAEA,MAAMC,WAAW,SAAXA,QAAW,CAACC,QAAD,EAAc;AAC7BH,QAAI,OAAJ;AACA,QAAII,gBAAgB,SAAhBA,aAAgB,CAACC,KAAD,EAAW;AAC7B,UAAIF,SAASG,IAAb,EAAmB;AACjBN,YAAIK,KAAJ;AACAF,iBAASG,IAAT,CAAcD,KAAd;AACD,OAHD,MAGO;AACL,cAAM,IAAIE,KAAJ,CAAU,qCAAV,CAAN;AACD;AACF,KAPD;AAQAf,SAAKO,EAAL,EAASK,aAAT;AACD,GAXD;;AAaA,SAAO,iBAAWI,MAAX,CAAkBN,QAAlB,CAAP;AACD;;AAEM,SAASX,KAAT,OAEJ;AAAA,MADDkB,KACC,QADDA,KACC;;AACDA,QAAMnB,GAAN,GAAY,UAAUG,IAAV,EAAgB;AAC1B,WAAOH,IAAI,IAAJ,EAAUG,IAAV,CAAP;AACD,GAFD;AAGA,SAAOgB,KAAP;AACD","file":"rx.js","sourcesContent":["import {\n  Observable\n} from 'rxjs';\nimport Gun from 'gun/gun';\n\n// See https://github.com/staltz/xstream\nexport function $rx(node, opts = {}) {\n  let id, name\n  node.val(data => {\n    id = Gun.node.soul(data)\n    name = opts.name || id || 'unknown'\n  })\n  const op = opts.op || 'on'\n  const log = function (...args) {\n    if (opts.log) {\n      console.log('rx:', name, ...args)\n    }\n  }\n\n  // see Producer https://github.com/staltz/xstream#producer\n\n  const observer = (listener) => {\n    log('start')\n    let eventListener = (event) => {\n      if (listener.next) {\n        log(event)\n        listener.next(event)\n      } else {\n        throw new Error('Listener missing next(event) method')\n      }\n    }\n    node[op](eventListener);\n  }\n\n  return Observable.create(observer)\n};\n\nexport function addRx({\n  chain\n}) {\n  chain.$rx = function (opts) {\n    return $rx(this, opts)\n  }\n  return chain\n}"]}